{extend name="layout:phantomjs:base" /}

{block name="content"}
<div class="shift">
    <div class="shift__down">
        <div class="grid navigator">
            <div class="grid_9 push_3">
                <div class="post">
                    <h1>构建</h1>

                    <p>除非你有特殊需求需要使用源代码构建 PhantomJS, 否则我们强烈建议你使用现成的 <a href="<?php echo url('download');?>" target="_blank">二进制安装包</a> 进行安装.</p>

                    <h2 id="requirements">Requirements</h2>

                    <h3 id="hardware-requirements">硬件要求</h3>

                    <ul>
                        <li>内存(RAM): 4 GB以上</li>
                        <li>磁盘空间(Disk space): 3 GB以上</li>
                        <li>CPU: 1.8 GHz, 4 以上</li>
                    </ul>
                    <p>PhantomJS 本质上是一个无头部的网页浏览器。 因此，从源代码构建它需要很长时间(主要是由于WebKit模块中有数千个文件)。4核系统大概需要30分钟时间去构建它。</p>

                    <h3 id="linux-requirements">Linux 依赖</h3>

                    <p>首先, 安装这些工具和包: GNU C++ compiler, bison, flex, gperf, Perl, Ruby, SQLite, FreeType, Fontconfig, OpenSSL, 以及 ICU。实际的包名可能会从一个分布到另一个分布。</p>

                    <p>基于debianbased的发行版(已在Ubuntu 14.04和Debian 7.0上测试通过), 执行:</p>

                    <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo apt-get install build-essential g++ flex bison gperf ruby perl <span class="se">\</span>
  libsqlite3-dev libfontconfig1-dev libicu-dev libfreetype6 libssl-dev <span class="se">\</span>
  libpng-dev libjpeg-dev python libx11-dev libxext-dev
</code></pre>
                    </div>

                    <p><strong>注意</strong>: 我们强烈建议你安装 <code class="highlighter-rouge">ttf-mscorefonts-installer</code> 字体库.</p>

                    <p>基于fedora的发行版(已在CentOS 6上测试通过), 执行:</p>

                    <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sudo yum -y install gcc gcc-c++ make flex bison gperf ruby <span class="se">\</span>
  openssl-devel freetype-devel fontconfig-devel libicu-devel sqlite-devel <span class="se">\</span>
  libpng-devel libjpeg-devel
</code></pre>
                    </div>

                    <h3 id="windows-requirements">Windows 依赖</h3>

                    <p>依赖工具: <code class="highlighter-rouge">MSVC2012</code> 和 <code class="highlighter-rouge">MSVC2013</code>.</p>

                    <p>你必须已安装 Perl, Python, Ruby, 和 Git 且将他们的执行文件所在路径写入到系统<code class="highlighter-rouge">PATH</code>中 。同时, 注意Git已附带了它自己的<code class="highlighter-rouge">perl.exe</code>版本 。如果您同时单独安装了Git和Perl安装, 请确保将Perl安装的bin文件路径写在放在git的bin文件路径之前 。</p>

                    <p>
                        请将文件夹<code class="highlighter-rouge">&lt;phantomjs_path&gt;\src\qt\3rdparty\gnuwin32\bin</code>放到系统路径中，
                        否则诸如<code class="highlighter-rouge">bison</code>、<code class="highlighter-rouge">flex</code>和<code class="highlighter-rouge">gperf</code>等需要的工具将不会被发现
                        例如:
                    </p>

                    <div class="highlighter-rouge"><pre class="highlight"><code>SET PATH=%CD%\src\qt\3rdparty\gnuwin32\bin;%PATH%
</code></pre>
                    </div>

                    <p>从Visual Studio命令提示符运行编译脚本</p>

                    <p><strong>小技巧</strong>: 启用增量链接将使连接过程更快。</p>

                    <h3 id="os-x-requirements">OS X 依赖</h3>

                    <ul>
                        <li><a href="https://developer.apple.com/xcode/">Xcode</a> 开发所必须的SDK (gcc, various tools, libraries, etc)</li>
                        <li>OpenSSL via <a href="http://brew.sh/">Homebrew</a> 或者 via <a href="https://www.macports.org/">MacPorts</a></li>
                    </ul>

                    <h3 id="freebsd-requirements">FreeBSD 依赖</h3>

                    <p>从FreeBSD端口集合构建Phantomjs: <a target="_blank" href="https://svnweb.freebsd.org/ports/head/lang/phantomjs/">svnweb.freebsd.org/ports/head/lang/phantomjs/</a></p>

                    <h2 id="getting-the-code">获取代码</h2>

                    <p>从官方的<a href="http://git-scm.com/">Git</a>仓库获取源代码 <a href="https://github.com/ariya/phantomjs/">github.com/ariya/phantomjs</a>:</p>

                    <div class="language-bash highlighter-rouge"><pre class="highlight"><code>git clone git://github.com/ariya/phantomjs.git
<span class="nb">cd </span>phantomjs
git checkout 2.1.1
git submodule init
git submodule update
</code></pre>
                    </div>

                    <h2 id="compile-and-link">编译和链接</h2>

                    <p>从源代码调出(checkout):</p>

                    <div class="language-bash highlighter-rouge"><pre class="highlight"><code>python build.py
</code></pre>
                    </div>

                    <p>这需要一些时间。一旦完成后，可执行文件可以在<code class="highlighter-rouge">bin</code>目录下找到。</p>

                    <p><strong>小技巧</strong>: 当编译过程被意外中断后，不要担心, 重新执行 <code class="highlighter-rouge">python build.py</code> 将会从上次中断的地方继续执行。</p>

                </div>
            </div>
            {include file="layout:phantomjs:sidebar"}
        </div>
    </div>

    {:widget('phantomjs/improvehtml', ['url' => 'https://github.com/ariya/phantomjs/edit/gh-pages/_posts/documentation/get-started/2000-01-02-build.md'])}
</div>

{include file="layout:phantomjs:community"}
{/block}